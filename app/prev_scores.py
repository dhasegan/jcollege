
from app.models import *

import json
import datetime

PREV_SCORES = []

def get_highscores_people(students):
    sorted_students = sorted(students, key=lambda x: x['points'], reverse=True)
    students_list = []
    for st in sorted_students:
        stds = Student.objects.filter(jid=st['jid'])
        if len(stds) != 1:
            continue
        std = stds[0]
        students_list.append({
            'student': std,
            'points': st['points']
        })
    return students_list[0:100]

def get_highscores_colleges(colleges):
    sorted_colleges = sorted(colleges, key=lambda x: x['points'], reverse=True)
    colleges_list = []
    for col in sorted_colleges:
        colleges_list.append({
            'name': dict(COLLEGES)[ col['name'] ],
            'points': col['points']
        })
    return colleges_list

# Load session1 into PREV_SCORES
session1_datapoints_people = json.loads('{"time": 1393514093, "all_points": [{"points": 5, "jid": "286", "name": "Anja Djokic"}, {"points": 136, "jid": "343", "name": "Andrei Iosif Smid"}, {"points": 168, "jid": "162", "name": "Henok Girma Nida"}, {"points": 3443, "jid": "159", "name": "Siddharth Shukla"}, {"points": 326, "jid": "71", "name": "Kamila Radikovna Mustafina"}, {"points": 8, "jid": "85", "name": "Ximena Jos\\u00e9 Guevara"}, {"points": 51, "jid": "41", "name": "Enxhell M Luzhnica"}, {"points": 52, "jid": "93", "name": "Dilantha Arjuna Suriyaarachchi Perera"}, {"points": 324, "jid": "255", "name": "Chanindu Ranatunga"}, {"points": 735, "jid": "29", "name": "Uneeb Adeel Agha"}, {"points": 19, "jid": "142", "name": "Cristian Pana"}, {"points": 94, "jid": "65", "name": "Hanna Kuznetsova"}, {"points": 52, "jid": "602", "name": "Deya Kuhnle"}, {"points": 318, "jid": "398", "name": "Maria Alexandra Ilie"}, {"points": 92, "jid": "537", "name": "Timo L\\u00fccke"}, {"points": 18, "jid": "1235", "name": "Seung Gyu Im"}, {"points": 12346, "jid": "883", "name": "Sevda Pinar Kiratli"}, {"points": 4, "jid": "804", "name": "Dalia M Hashweh"}, {"points": 103, "jid": "958", "name": "Fatma Salma Houerbi"}, {"points": 615, "jid": "1033", "name": "Bharath Rabindranath Bharadwaj"}, {"points": 37, "jid": "417", "name": "Gesa Marie K\\u00f6rte"}, {"points": 120, "jid": "1063", "name": "Asfandyar Ashraf Malik"}, {"points": 2042, "jid": "1243", "name": "Alper Yildirim"}, {"points": 22, "jid": "741", "name": "Ashley Elizabeth Zheng"}, {"points": 11, "jid": "1685", "name": "Sidharth Dandekar"}, {"points": 1252, "jid": "1757", "name": "Lucie Anna Christa Maria Knor"}, {"points": 299, "jid": "1640", "name": "Oleksandra O Boychenko"}, {"points": 1163, "jid": "1567", "name": "Carmela Acevedo"}, {"points": 48, "jid": "1532", "name": "Dana M Breseman"}, {"points": 14, "jid": "1412", "name": "Michael Andargachew Mekonnen"}, {"points": 640, "jid": "1955", "name": "Cornel Maximilian Amler"}, {"points": 525, "jid": "1556", "name": "Ngoc Linh Nguyen"}, {"points": 168, "jid": "1882", "name": "Ingo Alan Wagner"}, {"points": 112, "jid": "1756", "name": "Manish Kumar"}, {"points": 3, "jid": "2532", "name": "Ali Nawaz"}, {"points": 374, "jid": "2091", "name": "Catalin Florian Perticas"}, {"points": 8, "jid": "2336", "name": "Andrei Iulian Militaru"}, {"points": 106, "jid": "2582", "name": "Francisco Diaz"}, {"points": 147, "jid": "2184", "name": "Andrei Cristian Ignat"}, {"points": 118, "jid": "2378", "name": "Dorin Gabriel Clisu"}, {"points": 44, "jid": "542", "name": "Bishesh Tiwaree"}, {"points": 175, "jid": "174", "name": "Ahmed Farooq Cheema"}, {"points": 857, "jid": "198", "name": "Tomas Pllaha"}, {"points": 94, "jid": "696", "name": "Roxana Nadrag"}, {"points": 154, "jid": "918", "name": "Gautam Rai"}, {"points": 806, "jid": "1214", "name": "Sourabh Lal"}, {"points": 18, "jid": "1110", "name": "Utz Heinrich Ermel"}, {"points": 46, "jid": "1001", "name": "Ionut Codrin Amariei"}, {"points": 58, "jid": "1725", "name": "Fiona Harnischfeger"}, {"points": 169, "jid": "1677", "name": "Emily Eva-Maria Waller"}, {"points": 99, "jid": "1570", "name": "Rubens Gomes Neto"}, {"points": 1219, "jid": "1400", "name": "Ana-Maria Brecan"}, {"points": 1, "jid": "1322", "name": "Ana Ivan"}, {"points": 1674, "jid": "1765", "name": "Nina Kr\\u00fcger"}, {"points": 70, "jid": "1623", "name": "Stiv Klaud Sherko"}, {"points": 783, "jid": "45", "name": "Albena Milkova Bogoeva"}, {"points": 61, "jid": "2339", "name": "Mihai Fieraru"}, {"points": 809, "jid": "2330", "name": "Cristian Mihai Munteanu"}, {"points": 8, "jid": "51", "name": "Maryana Yurievna Morina"}, {"points": 327, "jid": "88", "name": "Romina Nikolova Nikolova"}, {"points": 44, "jid": "184", "name": "Manish Jung Thapa"}, {"points": 3, "jid": "158", "name": "Andreea Ioana Popa"}, {"points": 318, "jid": "404", "name": "Jan-David Franke"}, {"points": 11, "jid": "187", "name": "Viktorija Paneva"}, {"points": 664, "jid": "193", "name": "Bappa Maitra"}, {"points": 38, "jid": "327", "name": "Jonathan Georg Bechtold"}, {"points": 573, "jid": "154", "name": "Razvan Ioan Panea"}, {"points": 26, "jid": "442", "name": "Louis Antoine Lagoutte"}, {"points": 124, "jid": "295", "name": "Mihai Baltac"}, {"points": 62, "jid": "344", "name": "Saad Saeed"}, {"points": 112, "jid": "334", "name": "Salman Saeed"}, {"points": 629, "jid": "857", "name": "Utkrist Adhikari"}, {"points": 1737, "jid": "974", "name": "Magda Chichifoi"}, {"points": 61, "jid": "644", "name": "Keno Tetzlaff"}, {"points": 115, "jid": "894", "name": "Alexandra Crai"}, {"points": 168, "jid": "1016", "name": "Sardar Imran Hussain Bali"}, {"points": 1155, "jid": "1260", "name": "Eric Francis Bezzam"}, {"points": 1244, "jid": "1331", "name": "Hasan Abdur Rahman"}, {"points": 202, "jid": "1548", "name": "Stephanie Catherin Castan"}, {"points": 78, "jid": "2005", "name": "Radu Bors"}, {"points": 3, "jid": "1746", "name": "Archishman Sarkar"}, {"points": 2222, "jid": "2174", "name": "Alexandru Dominic Git"}, {"points": 3287, "jid": "1836", "name": "Ricarda Marie Sch\\u00e4fer"}, {"points": 93, "jid": "1708", "name": "Joshua David Frenster"}, {"points": 168, "jid": "1643", "name": "Sarah Camargo Tomaz Cleto"}, {"points": 19, "jid": "2036", "name": "Stefan Timiras"}, {"points": 45, "jid": "1909", "name": "Tim Sudmeier"}, {"points": 101, "jid": "1672", "name": "Muhammad Hassaan Farooq"}, {"points": 4, "jid": "2392", "name": "Aleksandar Gyorev"}, {"points": 168, "jid": "2328", "name": "Tudor Olariu"}, {"points": 217, "jid": "2416", "name": "Georgi Yuliyanov Gyurchev"}, {"points": 52, "jid": "2370", "name": "Denis Rochau"}, {"points": 620, "jid": "86", "name": "Vlad Popa-Florea"}, {"points": 101, "jid": "666", "name": "Stefan Appelhoff"}, {"points": 145, "jid": "473", "name": "Lorna Helene Natalia Sch\\u00fctte"}, {"points": 198, "jid": "155", "name": "Alexandru Popa"}, {"points": 77, "jid": "763", "name": "Austin Nicholas Hugenberg"}, {"points": 400, "jid": "983", "name": "Filip Stankovski"}, {"points": 173, "jid": "943", "name": "Paola Iljazi"}, {"points": 65, "jid": "1122", "name": "Sparsh Agarwal"}, {"points": 171, "jid": "1031", "name": "Rrita Limaj"}, {"points": 5, "jid": "1553", "name": "Dmitrii Cucleschin"}, {"points": 43, "jid": "2161", "name": "Domingo Antonio Vivas Peleteiro"}, {"points": 409, "jid": "1911", "name": "Namratha Nair"}, {"points": 10, "jid": "1903", "name": "Pranta Shatabdi Majumder"}, {"points": 49, "jid": "2280", "name": "Vlad Victor Ungureanu"}, {"points": 20, "jid": "414", "name": "Nicholas Matthew Lee"}, {"points": 622, "jid": "2481", "name": "Joshan Chaudhary"}, {"points": 18, "jid": "1695", "name": "Hauke Zie\\u00c3\\u0178ler"}, {"points": 93, "jid": "1002", "name": "Aman Bhattarai"}, {"points": 16, "jid": "46", "name": "Andreea Teodora Buteata"}, {"points": 70, "jid": "2199", "name": "Suryansh Pant"}, {"points": 630, "jid": "2341", "name": "Anastasia Resteu"}, {"points": 28, "jid": "1793", "name": "Johannes Gabriel Bachhuber"}, {"points": 194, "jid": "1935", "name": "Lebriz Kiziler"}, {"points": 168, "jid": "2431", "name": "Nikolche Kolev"}, {"points": 1234, "jid": "84", "name": "Nikhil Ratna Shakya"}, {"points": 298, "jid": "1972", "name": "Fran\\u00e7oise Emiel De Sutter"}, {"points": 12345, "jid": "1188", "name": "Prabal Poudel"}, {"points": 116, "jid": "646", "name": "Miriam Isabell Wulf"}, {"points": 94, "jid": "2050", "name": "Deyan Ivelinov Ginev"}, {"points": 2777, "jid": "1399", "name": "Daniel Hasegan"}, {"points": 55, "jid": "247", "name": "Ratna Bahadur Bista"}, {"points": 144, "jid": "11189", "name": "Corneliu Claudiu Prodescu"}, {"points": 359, "jid": "2268", "name": "Cristiana Dimulescu"}, {"points": 43, "jid": "712", "name": "Mengyuan Zhang"}, {"points": 2222, "jid": "113", "name": "Risav Karna"}, {"points": 494, "jid": "1157", "name": "Dominik Kundel"}, {"points": 1239, "jid": "901", "name": "Megi Mustafai"}]}')
session1_datapoints_colleges = json.loads('[{"points": 6635, "name": "N"}, {"points": 18610, "name": "C"}, {"points": 17663, "name": "K"}, {"points": 30170, "name": "M"}]')
session1_details = {
    'name': 'February Contest',
    'time_start': datetime.datetime(year=2014, month=2, day=2),
    'time_end': datetime.datetime(year=2014, month=2, day=26),
    'students': get_highscores_people(session1_datapoints_people['all_points']),
    'colleges': get_highscores_colleges(session1_datapoints_colleges)
}
PREV_SCORES.append(session1_details)
